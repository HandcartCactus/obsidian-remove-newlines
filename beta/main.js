/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => RemoveNewline
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// utils.ts
var import_obsidian = require("obsidian");
var removeNewlines = function(text, fixHyphenation, fixWhitespace) {
  if (fixHyphenation) {
    text = text.replace(/-(\r\n|\r|\n)/g, "");
  }
  text = text.replace(/(\r\n|\r|\n)/g, " ");
  if (fixWhitespace) {
    text = text.replace(/\s{2,}/g, " ");
  }
  return text;
};
var removeBlankLines = function(text) {
  text = text.split(/\r?\n/).filter((line) => line.trim() !== "").join("\n");
  return text;
};
var clipboardItemToString = async function(item) {
  if (item.types.includes("text/html")) {
    const html = await (await item.getType("text/html")).text();
    return (0, import_obsidian.htmlToMarkdown)(html);
  }
  if (item.types.includes("text/plain")) {
    return await (await item.getType("text/plain")).text();
  }
  return null;
};

// main.ts
var DEFAULT_SETTINGS = {
  fixWhitespace: true,
  fixHyphenation: true
};
var RemoveNewline = class extends import_obsidian2.Plugin {
  constructor() {
    super(...arguments);
    // cleaning methods are wrapped so we can pass settings as params
    this.removeNewlines = (text) => {
      return removeNewlines(text, this.settings.fixHyphenation, this.settings.fixWhitespace);
    };
    this.removeBlankLines = (text) => {
      return removeBlankLines(text);
    };
    this.transformSelection = (editor, transformFn) => {
      let selection = editor.getSelection();
      selection = transformFn(selection);
      editor.replaceSelection(selection);
    };
    this.removeNewlinesFromSelection = (editor) => {
      this.transformSelection(editor, this.removeNewlines);
    };
    this.removeBlankLinesFromSelection = (editor) => {
      this.transformSelection(editor, this.removeBlankLines);
    };
    this.pasteTransformed = async (editor, transformFn) => {
      const clipboardItems = await navigator.clipboard.read();
      const textToTransform = await clipboardItemToString(clipboardItems[0]);
      if (!textToTransform) return;
      const transformedText = transformFn(textToTransform);
      editor.replaceSelection(transformedText);
    };
    this.pasteWithoutNewlines = async (editor) => {
      this.pasteTransformed(editor, this.removeNewlines);
    };
    this.pasteWithoutBlankLines = async (editor) => {
      this.pasteTransformed(editor, this.removeBlankLines);
    };
  }
  async onload() {
    await this.loadSettings();
    this.addCommand({
      id: "remove-newlines-from-selection",
      name: "Remove newlines from selection",
      editorCheckCallback: (checking, editor, ctx) => {
        if (editor.somethingSelected()) {
          if (!checking) {
            if (typeof this.removeNewlinesFromSelection !== "function") {
              console.error("removeNewlinesFromSelection is not defined or not a function.");
              return false;
            }
            this.removeNewlinesFromSelection(editor);
          }
          return true;
        }
        return false;
      }
    });
    this.addCommand({
      id: "paste-without-newlines",
      name: "Paste without newlines",
      editorCallback: (editor) => {
        if (typeof this.pasteWithoutNewlines !== "function") {
          console.error("pasteWithoutNewlines is not defined or not a function.");
          return;
        }
        void this.pasteWithoutNewlines(editor);
      }
    });
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        menu.addItem((item) => {
          item.setTitle("Remove newlines from selection").setIcon("square-bottom-dashed-scissors").setDisabled(!editor.somethingSelected()).onClick(() => {
            this.removeNewlinesFromSelection(editor);
          });
        });
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        menu.addItem((item) => {
          item.setTitle("Paste without newlines").setIcon("clipboard-paste").onClick(() => {
            void this.pasteWithoutNewlines(editor);
          });
        });
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        menu.addItem((item) => {
          item.setTitle("Remove blank lines from selection").setIcon("square-bottom-dashed-scissors").setDisabled(!editor.somethingSelected()).onClick(() => this.removeBlankLinesFromSelection(editor));
        });
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        menu.addItem((item) => {
          item.setTitle("Paste without blank lines").setIcon("clipboard-paste").onClick(() => {
            void this.pasteWithoutBlankLines(editor);
          });
        });
      })
    );
    this.addCommand({
      id: "paste-without-blank-lines",
      name: "Paste without blank lines",
      editorCallback: (editor) => {
        void this.pasteWithoutBlankLines(editor);
      }
    });
    this.addCommand({
      id: "remove-blank-lines-from-selection",
      name: "Remove blank lines from selection",
      editorCheckCallback: (checking, editor, ctx) => {
        if (editor.somethingSelected()) {
          if (!checking) {
            this.removeBlankLinesFromSelection(editor);
          }
          return true;
        }
        return false;
      }
    });
    this.addSettingTab(new RemoveNewlineSettingsTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var RemoveNewlineSettingsTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Fix whitespace when removing newlines").setDesc(
      "Remove two or more whitespace characters in a row from the selection after removing the newlines. (Recommended)"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.fixWhitespace).onChange(async (value) => {
        this.plugin.settings.fixWhitespace = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Fix hyphenation when removing newlines").setDesc(
      "If on, removes hyphens from the end of a line and also does not put a space where the newline was."
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.fixHyphenation).onChange(async (value) => {
        this.plugin.settings.fixHyphenation = value;
        await this.plugin.saveSettings();
      })
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJ1dGlscy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLy8gaHR0cHM6Ly94LmNvbS9MZWdhY3lSdXNzZWxsL3N0YXR1cy8xMzY2NTg0MTQ1MjcxNDg4NTIyXG5pbXBvcnQge1xuXHRBcHAsXG5cdEVkaXRvcixcblx0UGx1Z2luLFxuXHRQbHVnaW5TZXR0aW5nVGFiLFxuXHRTZXR0aW5nLFxufSBmcm9tIFwib2JzaWRpYW5cIjtcblxuaW1wb3J0IHsgcmVtb3ZlTmV3bGluZXMsIHJlbW92ZUJsYW5rTGluZXMsIGNsaXBib2FyZEl0ZW1Ub1N0cmluZyB9IGZyb20gXCJ1dGlsc1wiO1xuXG5pbnRlcmZhY2UgUmVtb3ZlTmV3bGluZVNldHRpbmdzIHtcblx0Zml4V2hpdGVzcGFjZTogYm9vbGVhbjtcblx0Zml4SHlwaGVuYXRpb246IGJvb2xlYW47XG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFJlbW92ZU5ld2xpbmVTZXR0aW5ncyA9IHtcblx0Zml4V2hpdGVzcGFjZTogdHJ1ZSxcblx0Zml4SHlwaGVuYXRpb246IHRydWUsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZW1vdmVOZXdsaW5lIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IFJlbW92ZU5ld2xpbmVTZXR0aW5ncztcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdC8vIENvbW1hbmQgLyBSZW1vdmUgbmV3bGluZXMgLyBTZWxlY3Rpb25cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwicmVtb3ZlLW5ld2xpbmVzLWZyb20tc2VsZWN0aW9uXCIsXG5cdFx0XHRuYW1lOiBcIlJlbW92ZSBuZXdsaW5lcyBmcm9tIHNlbGVjdGlvblwiLFxuXHRcdFx0ZWRpdG9yQ2hlY2tDYWxsYmFjazogKGNoZWNraW5nLCBlZGl0b3IsIGN0eCkgPT4ge1xuXHRcdFx0XHRpZiAoZWRpdG9yLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcblx0XHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XG5cdFx0XHRcdFx0XHRpZiAodHlwZW9mIHRoaXMucmVtb3ZlTmV3bGluZXNGcm9tU2VsZWN0aW9uICE9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihcInJlbW92ZU5ld2xpbmVzRnJvbVNlbGVjdGlvbiBpcyBub3QgZGVmaW5lZCBvciBub3QgYSBmdW5jdGlvbi5cIik7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHRoaXMucmVtb3ZlTmV3bGluZXNGcm9tU2VsZWN0aW9uKGVkaXRvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cdFx0Ly8gQ29tbWFuZCAvIFJlbW92ZSBuZXdsaW5lcyAvIFBhc3RlXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcInBhc3RlLXdpdGhvdXQtbmV3bGluZXNcIixcblx0XHRcdG5hbWU6IFwiUGFzdGUgd2l0aG91dCBuZXdsaW5lc1wiLFxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3IpID0+IHtcblx0XHRcdFx0aWYgKHR5cGVvZiB0aGlzLnBhc3RlV2l0aG91dE5ld2xpbmVzICE9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwicGFzdGVXaXRob3V0TmV3bGluZXMgaXMgbm90IGRlZmluZWQgb3Igbm90IGEgZnVuY3Rpb24uXCIpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHR2b2lkIHRoaXMucGFzdGVXaXRob3V0TmV3bGluZXMoZWRpdG9yKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHQvLyBDb250ZXh0IG1lbnUgLyBSZW1vdmUgbmV3bGluZXMgLyBTZWxlY3Rpb25cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJlZGl0b3ItbWVudVwiLCAobWVudSwgZWRpdG9yLCB2aWV3KSA9PiB7XG5cdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJSZW1vdmUgbmV3bGluZXMgZnJvbSBzZWxlY3Rpb25cIilcblx0XHRcdFx0XHRcdC5zZXRJY29uKFwic3F1YXJlLWJvdHRvbS1kYXNoZWQtc2Npc3NvcnNcIilcblx0XHRcdFx0XHRcdC5zZXREaXNhYmxlZCghZWRpdG9yLnNvbWV0aGluZ1NlbGVjdGVkKCkpXG5cdFx0XHRcdFx0XHQub25DbGljaygoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucmVtb3ZlTmV3bGluZXNGcm9tU2VsZWN0aW9uKGVkaXRvcik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KVxuXHRcdCk7XG5cblx0XHQvLyBDb250ZXh0IG1lbnUgIC8gUmVtb3ZlIG5ld2xpbmVzICAvIFBhc3RlXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZWRpdG9yLW1lbnVcIiwgKG1lbnUsIGVkaXRvciwgdmlldykgPT4ge1xuXHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiUGFzdGUgd2l0aG91dCBuZXdsaW5lc1wiKVxuXHRcdFx0XHRcdFx0LnNldEljb24oXCJjbGlwYm9hcmQtcGFzdGVcIilcblx0XHRcdFx0XHRcdC8vLnNldERpc2FibGVkKHRoaXMuY2xpcGJvYXJkSGFzVGV4dCgpKVxuXHRcdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHR2b2lkIHRoaXMucGFzdGVXaXRob3V0TmV3bGluZXMoZWRpdG9yKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pXG5cdFx0KTtcblxuXHRcdC8vIENvbnRleHQgbWVudSAvIFJlbW92ZSBCbGFuayBMaW5lcyAvIFNlbGVjdGlvblxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImVkaXRvci1tZW51XCIsIChtZW51LCBlZGl0b3IsIHZpZXcpID0+IHtcblx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSAgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJSZW1vdmUgYmxhbmsgbGluZXMgZnJvbSBzZWxlY3Rpb25cIilcblx0XHRcdFx0XHRcdC5zZXRJY29uKFwic3F1YXJlLWJvdHRvbS1kYXNoZWQtc2Npc3NvcnNcIilcblx0XHRcdFx0XHRcdC5zZXREaXNhYmxlZCghZWRpdG9yLnNvbWV0aGluZ1NlbGVjdGVkKCkpXG5cdFx0XHRcdFx0XHQub25DbGljaygoKSA9PiB0aGlzLnJlbW92ZUJsYW5rTGluZXNGcm9tU2VsZWN0aW9uKGVkaXRvcikpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pXG5cdFx0KTtcblxuXHRcdC8vIENvbnRleHQgbWVudSAvIFJlbW92ZSBCbGFuayBMaW5lcyAvIFBhc3RlXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZWRpdG9yLW1lbnVcIiwgKG1lbnUsIGVkaXRvciwgdmlldykgPT4ge1xuXHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiUGFzdGUgd2l0aG91dCBibGFuayBsaW5lc1wiKVxuXHRcdFx0XHRcdFx0LnNldEljb24oXCJjbGlwYm9hcmQtcGFzdGVcIilcblx0XHRcdFx0XHRcdC8vLnNldERpc2FibGVkKHRoaXMuY2xpcGJvYXJkSGFzVGV4dCgpKVxuXHRcdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHR2b2lkIHRoaXMucGFzdGVXaXRob3V0QmxhbmtMaW5lcyhlZGl0b3IpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSlcblx0XHQpO1xuXG5cdFx0Ly8gQ29tbWFuZCAvIFJlbW92ZSBCbGFuayBMaW5lcyAvIFBhc3RlXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcInBhc3RlLXdpdGhvdXQtYmxhbmstbGluZXNcIixcblx0XHRcdG5hbWU6IFwiUGFzdGUgd2l0aG91dCBibGFuayBsaW5lc1wiLFxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3IpID0+IHtcblx0XHRcdFx0dm9pZCB0aGlzLnBhc3RlV2l0aG91dEJsYW5rTGluZXMoZWRpdG9yKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHQvLyBDb21tYW5kICAvIFJlbW92ZSBCbGFuayBMaW5lcyAgLyBTZWxlY3Rpb25cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwicmVtb3ZlLWJsYW5rLWxpbmVzLWZyb20tc2VsZWN0aW9uXCIsXG5cdFx0XHRuYW1lOiBcIlJlbW92ZSBibGFuayBsaW5lcyBmcm9tIHNlbGVjdGlvblwiLFxuXHRcdFx0ZWRpdG9yQ2hlY2tDYWxsYmFjazogKGNoZWNraW5nLCBlZGl0b3IsIGN0eCkgPT4ge1xuXHRcdFx0XHRpZiAoZWRpdG9yLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcblx0XHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlbW92ZUJsYW5rTGluZXNGcm9tU2VsZWN0aW9uKGVkaXRvcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFJlbW92ZU5ld2xpbmVTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXHR9XG5cblx0b251bmxvYWQoKSB7fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbihcblx0XHRcdHt9LFxuXHRcdFx0REVGQVVMVF9TRVRUSU5HUyxcblx0XHRcdGF3YWl0IHRoaXMubG9hZERhdGEoKVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxuXG5cblxuXHQvLyBjbGVhbmluZyBtZXRob2RzIGFyZSB3cmFwcGVkIHNvIHdlIGNhbiBwYXNzIHNldHRpbmdzIGFzIHBhcmFtc1xuXHRyZW1vdmVOZXdsaW5lcyA9ICh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuXHRcdHJldHVybiByZW1vdmVOZXdsaW5lcyh0ZXh0LCB0aGlzLnNldHRpbmdzLmZpeEh5cGhlbmF0aW9uLCB0aGlzLnNldHRpbmdzLmZpeFdoaXRlc3BhY2UpO1xuXHR9XG5cblx0cmVtb3ZlQmxhbmtMaW5lcyA9ICh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuXHRcdHJldHVybiByZW1vdmVCbGFua0xpbmVzKHRleHQpO1xuXHR9XG5cblxuXG5cdHRyYW5zZm9ybVNlbGVjdGlvbiA9IChlZGl0b3I6IEVkaXRvciwgdHJhbnNmb3JtRm46ICh0ZXh0OiBzdHJpbmcpID0+IHN0cmluZyk6IHZvaWQgPT4gIHtcblx0XHRsZXQgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuXG5cdFx0c2VsZWN0aW9uID0gdHJhbnNmb3JtRm4oc2VsZWN0aW9uKTtcblxuXHRcdGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKHNlbGVjdGlvbik7XG5cdH1cblxuXHRyZW1vdmVOZXdsaW5lc0Zyb21TZWxlY3Rpb24gPSAoZWRpdG9yOiBFZGl0b3IpOiB2b2lkID0+ICB7XG5cdFx0dGhpcy50cmFuc2Zvcm1TZWxlY3Rpb24oZWRpdG9yLCB0aGlzLnJlbW92ZU5ld2xpbmVzKTtcblx0fVxuXG5cdHJlbW92ZUJsYW5rTGluZXNGcm9tU2VsZWN0aW9uID0gKGVkaXRvcjogRWRpdG9yKTogdm9pZCA9PiAge1xuXHRcdHRoaXMudHJhbnNmb3JtU2VsZWN0aW9uKGVkaXRvciwgdGhpcy5yZW1vdmVCbGFua0xpbmVzKTtcblx0fVxuXG5cblxuXG5cdHBhc3RlVHJhbnNmb3JtZWQgPSBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIHRyYW5zZm9ybUZuOiAodGV4dDogc3RyaW5nKSA9PiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcblx0XHQvLyB1c2VkIHRvIGJlIC5yZWFkVGV4dCgpIGJ1dCBpdCB3YXMgc3RyaXBwaW5nIGZvcm1hdHRpbmcgZnJvbSBodG1sXG5cdFx0Y29uc3QgY2xpcGJvYXJkSXRlbXMgPSBhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLnJlYWQoKTtcblxuXHRcdC8vIEFGQUlDVCB0aGVyZSdzIG9ubHkgb25lIGl0ZW0gaW4gdGhlIENsaXBib2FyZEl0ZW1zIGFycmF5LiBJIHRoaW5rLlxuXHRcdC8vIGNsaXBib2FyZEl0ZW1Ub1N0cmluZyB3aWxsIHByZXNlcnZlIEhUTUwgZm9ybWF0dGluZywgLnJlYWRUZXh0KCkgd2lsbCBub3QuXG5cdFx0Y29uc3QgdGV4dFRvVHJhbnNmb3JtID0gYXdhaXQgY2xpcGJvYXJkSXRlbVRvU3RyaW5nKGNsaXBib2FyZEl0ZW1zWzBdKVxuXG5cdFx0aWYgKCF0ZXh0VG9UcmFuc2Zvcm0pIHJldHVybjtcblxuXHRcdGNvbnN0IHRyYW5zZm9ybWVkVGV4dCA9IHRyYW5zZm9ybUZuKHRleHRUb1RyYW5zZm9ybSk7XG5cblx0XHRlZGl0b3IucmVwbGFjZVNlbGVjdGlvbih0cmFuc2Zvcm1lZFRleHQpO1xuXHR9XG5cblx0cGFzdGVXaXRob3V0TmV3bGluZXMgPSBhc3luYyAoZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+ID0+IHtcblx0XHR0aGlzLnBhc3RlVHJhbnNmb3JtZWQoZWRpdG9yLCB0aGlzLnJlbW92ZU5ld2xpbmVzKTtcblx0fVxuXG5cdHBhc3RlV2l0aG91dEJsYW5rTGluZXMgPSBhc3luYyAoZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+ID0+IHtcblx0XHR0aGlzLnBhc3RlVHJhbnNmb3JtZWQoZWRpdG9yLCB0aGlzLnJlbW92ZUJsYW5rTGluZXMpO1xuXHR9XG59XG5cbmNsYXNzIFJlbW92ZU5ld2xpbmVTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IFJlbW92ZU5ld2xpbmU7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUmVtb3ZlTmV3bGluZSkge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0Y29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKFwiRml4IHdoaXRlc3BhY2Ugd2hlbiByZW1vdmluZyBuZXdsaW5lc1wiKVxuXHRcdFx0LnNldERlc2MoXG5cdFx0XHRcdFwiUmVtb3ZlIHR3byBvciBtb3JlIHdoaXRlc3BhY2UgY2hhcmFjdGVycyBpbiBhIHJvdyBmcm9tIHRoZSBzZWxlY3Rpb24gYWZ0ZXIgcmVtb3ZpbmcgdGhlIG5ld2xpbmVzLiAoUmVjb21tZW5kZWQpXCJcblx0XHRcdClcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cblx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZpeFdoaXRlc3BhY2UpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZml4V2hpdGVzcGFjZSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdCk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKFwiRml4IGh5cGhlbmF0aW9uIHdoZW4gcmVtb3ZpbmcgbmV3bGluZXNcIilcblx0XHRcdC5zZXREZXNjKFxuXHRcdFx0XHRcIklmIG9uLCByZW1vdmVzIGh5cGhlbnMgZnJvbSB0aGUgZW5kIG9mIGEgbGluZSBhbmQgYWxzbyBkb2VzIG5vdCBwdXQgYSBzcGFjZSB3aGVyZSB0aGUgbmV3bGluZSB3YXMuXCJcblx0XHRcdClcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cblx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZpeEh5cGhlbmF0aW9uKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZpeEh5cGhlbmF0aW9uID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0KTtcblx0fVxufVxuIiwgImltcG9ydCB7IGh0bWxUb01hcmtkb3duIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG4vKiBcblxuVGhpcyBmaWxlIHdhcyBicm9rZW4gb3V0IHNvIHRoYXQgSSBjb3VsZCBpbXBsZW1lbnQgdGVzdGluZyBmb3IgdGhlIHBsdWdpbi5cblxuKi9cblxuY29uc3QgcmVtb3ZlTmV3bGluZXMgPSBmdW5jdGlvbih0ZXh0OiBzdHJpbmcsIGZpeEh5cGhlbmF0aW9uOmJvb2xlYW4sIGZpeFdoaXRlc3BhY2U6Ym9vbGVhbik6IHN0cmluZyB7XG4gICAgICAgIFxuICAgIGlmIChmaXhIeXBoZW5hdGlvbikge1xuICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC8tKFxcclxcbnxcXHJ8XFxuKS9nLCBcIlwiKTtcbiAgICB9XG5cbiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC8oXFxyXFxufFxccnxcXG4pL2csIFwiIFwiKTtcblxuICAgIGlmIChmaXhXaGl0ZXNwYWNlKSB7XG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1xcc3syLH0vZywgXCIgXCIpO1xuICAgIH1cblxuICAgIHJldHVybiB0ZXh0O1xufVxuXG5jb25zdCByZW1vdmVCbGFua0xpbmVzID0gZnVuY3Rpb24odGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9bXFxyXFxuXSsoW1xcc10qW1xcclxcbl0rKSsvZywgXCJcXHJcXG5cIik7XG4gICAgdGV4dCA9IHRleHRcbiAgICAuc3BsaXQoL1xccj9cXG4vKVxuICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSAhPT0gXCJcIilcbiAgICAuam9pbihcIlxcblwiKTtcbiAgICByZXR1cm4gdGV4dDtcbn1cblxuY29uc3QgY2xpcGJvYXJkSXRlbVRvU3RyaW5nID0gYXN5bmMgZnVuY3Rpb24gKFxuXHRpdGVtOiBDbGlwYm9hcmRJdGVtXG4pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcblxuXHRpZiAoaXRlbS50eXBlcy5pbmNsdWRlcyhcInRleHQvaHRtbFwiKSkge1xuXHRcdGNvbnN0IGh0bWwgPSBhd2FpdCAoYXdhaXQgaXRlbS5nZXRUeXBlKFwidGV4dC9odG1sXCIpKS50ZXh0KCk7XG5cdFx0cmV0dXJuIGh0bWxUb01hcmtkb3duKGh0bWwpO1xuXHR9XG5cblx0aWYgKGl0ZW0udHlwZXMuaW5jbHVkZXMoXCJ0ZXh0L3BsYWluXCIpKSB7XG5cdFx0cmV0dXJuIGF3YWl0IChhd2FpdCBpdGVtLmdldFR5cGUoXCJ0ZXh0L3BsYWluXCIpKS50ZXh0KCk7XG5cdH1cblxuXHRyZXR1cm4gbnVsbDtcbn1cblxuXG5leHBvcnQgeyByZW1vdmVOZXdsaW5lcywgcmVtb3ZlQmxhbmtMaW5lcywgY2xpcGJvYXJkSXRlbVRvU3RyaW5nIH07Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtB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
